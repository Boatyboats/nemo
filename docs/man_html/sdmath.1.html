<!-- manual page source format generated by PolyglotMan v3.2, -->
<!-- available at http://polyglotman.sourceforge.net/ -->

<html>
<head>
<title>SDMATH(1NEMO) manual page</title>
</head>
<body bgcolor='white'>
This HTML automatically generated with <A HREF=http://manpages.ubuntu.com/manpages/bionic/man1/rman.1.html>rman</A> for <A HREF=https://astronemo.readthedocs.io>NEMO</A><br>
<a href='#toc'>Table of Contents</a><p>

<p> 
<h2><a name='sect0' href='#toc0'>Name</a></h2>
sdmath - SD math and file I/O bench 
<p> 
<h2><a name='sect1' href='#toc1'>Synopsis</a></h2>
<b>sdmath</b> [parameter=value]

<p> 
<h2><a name='sect2' href='#toc2'>Description</a></h2>
This is a benchmark for OpenMP parallellizable Single Dish
vector math in a typical ON/OFF with noise diodes CalON/CalOff to provide
a system temperature. <p>
Each spectrum (called row below) has <b>nchan</b> channels,
Each <b>nscan</b> has 4 rows, with the CalOn and CalOff for the Ref and the Sig.
 The following math is needed to construct a spectrum, taking 7 row operations,
thus the total operations is 7*nscan*nchan*iter <br>
<pre>    Tsys =  Tc * &lt;row3&gt; / &lt;row4-row3&gt;      &lt;cold&gt; / &lt;hot&gt;-&lt;cold&gt;
    off = row1 + row2
    on  = row3 + row4
    Ta = Tsys * (on/off - 1)
    
</pre>
<p> The benchmark here is very basic. A slightly more realistic one can be
found in <a href='sdinfo.1.html'><i>sdinfo(1NEMO)</i></a>
 reading actual <a href='sdfits.5.html'><i>sdfits(5NEMO)</i></a>
 files and selecting
a set of operations. 
<p> 
<h2><a name='sect3' href='#toc3'>Parameters</a></h2>
 The following parameters are recognized
in order; they may be given in any order if the keyword is also given. Use
<b>--help</b> to confirm this man page is up to date.  
<dl>

<dt><b>nscan=</b> </dt>
<dd>Number of scans. Can
be used to time-average (see <b>aver=</b> below). <br>
[1000]     </dd>

<dt><b>nchan=</b> </dt>
<dd>Number of channels. <br>
[100000]     </dd>

<dt><b>iter=</b> </dt>
<dd>How many times to iterate (0 means do nothing). <br>
[20] </dd>

<dt><b>mode=</b> </dt>
<dd>Mode of math (not implemented yet). Currently the equivalent
of a 4-phase PS observation is simulated, but a simpler 2-phase TP observation
should be implemented as well. <br>
[1]   </dd>

<dt><b>aver=t|f</b> </dt>
<dd>Add time average over nscan. <br>
[f]   </dd>

<dt><b>in=</b> </dt>
<dd>If given, read this file into memory. Meant to measure disk I/O
<br>
Not provided. </dd>

<dt><b>bs=</b> </dt>
<dd>Blocksize in kB to read with. <br>
[16] </dd>

<dt><b>maxbuf=</b> </dt>
<dd>Maximum buffer size (in MB) for reading buffer. If 0 is given,
the full filesize is used. <br>
[0] 
<p> 
<p> </dd>
</dl>

<h2><a name='sect4' href='#toc4'>Examples</a></h2>
An example performance on an Ultra 7 155H, measured in wall
clock time seconds, and iter=20: 
<p>  OMP_NUM_THREADS=2 /usr/bin/time sdmath
 1000 160000 iter=20 
<p> 
<p> nscan  nchan      1      2      4      8     12
    16     20  ----- ------    ---    ---    ---    ---    ---    ---    ---  1000 160000    7.8    5.0 
  3.9    4.2    3.7    3.6    5.7<br>
  2000  80000    7.8<br>
  4000  40000    7.8 <br>
  8000  20000    7.8<br>
 16000  10000    8.0    5.4    4.4    5.3    5.2    9.5    9.9 ----- ------    ---    ---    --- 
  ---    ---    ---    --- 
<p>  this implies around 4 Gop/sec. <p>
A read benchmark can be
done with a large series of Plummer models. The example file created here
is about 5GB in size:     mkplummer p1M 1000000 nmodel=100<br>
    /usr/bin/time sdmath  in=p1M<br>
    /usr/bin/time sdmath  in=p1M maxbuf=1000<br>
  the latter resets the buffer 5 times, where the last read is partial.

<p> 
<h2><a name='sect5' href='#toc5'>See Also</a></h2>
<a href='sdinfo.1.html'>sdinfo(1NEMO)</a>
, <a href='fits.5.html'>fits(5NEMO)</a>
 
<p> 
<h2><a name='sect6' href='#toc6'>Files</a></h2>
$NEMO/src/tutor/bench/sdmath.c
- code 
<p> 
<h2><a name='sect7' href='#toc7'>Author</a></h2>
Peter Teuben 
<p> 
<h2><a name='sect8' href='#toc8'>Update History</a></h2>
<br>
<pre>30-apr-2025<tt> </tt>&nbsp;<tt> </tt>&nbsp;Created<tt> </tt>&nbsp;<tt> </tt>&nbsp;<tt> </tt>&nbsp;<tt> </tt>&nbsp;PJT
</pre><p>

<hr><p>
<a name='toc'><b>Table of Contents</b></a><p>
<ul>
<li><a name='toc0' href='#sect0'>Name</a></li>
<li><a name='toc1' href='#sect1'>Synopsis</a></li>
<li><a name='toc2' href='#sect2'>Description</a></li>
<li><a name='toc3' href='#sect3'>Parameters</a></li>
<li><a name='toc4' href='#sect4'>Examples</a></li>
<li><a name='toc5' href='#sect5'>See Also</a></li>
<li><a name='toc6' href='#sect6'>Files</a></li>
<li><a name='toc7' href='#sect7'>Author</a></li>
<li><a name='toc8' href='#sect8'>Update History</a></li>
</ul>
</body>
</html>
